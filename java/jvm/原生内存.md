# 原生内存
在 Java 应用中，堆消耗的内存是最多的。但是除堆之外，JVM 还会分配并使用大量的原
生内存

## 内存占用 

### 测量内存占用
提交内存、保留内存
### 内存占用最小化
* 堆
* 线程栈
* 代码缓存
* 直接字节缓冲区

### 原生nio缓冲区
1. JVM 总的内存占用对性能影响很大，特别是当机器上的物理内存有限时。
在做性能测试时，内存占用通常应该是要监控的一个方面。
2. 从调优角度看，要控制 JVM 的内存占用，可以限制用于直接字节缓冲
区、线程栈和代码缓存的原生内存（以及堆）的使用量
### 原生内存跟踪
 -XX:NativeMemoryTracking=off|summary|detail   
1. 在 Java 8 中，原生内存跟踪（NMT）提供了 JVM 所使用的原生内存的详
细信息。从操作系统的角度看，其中包含 JVM 堆（对 OS 而言，堆也是
原生内存的一部分）。
2. 对大多数分析而言，NMT 的概要模式足够了。它支持我们确定 JVM 提
交了多少内存（以及这些内存用于干什么了）。

## 针对不同系统优化jvm
### 大页
1. 使用大页通常可以明显提升应用的速度。
2. 在大多数操作系统上，必须显式开启大页支持

### 压缩的oop (ordinary object pointer 即普通对象指针)
1. 压缩的 oop 会在最有用的时候默认开启。
2. 使用了压缩 oop 的 31 GB 的堆，与稍微大一些、但因为堆太大而无法使
用压缩 oop 的堆相比，性能通常要好一些
